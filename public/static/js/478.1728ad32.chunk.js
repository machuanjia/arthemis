(this["webpackJsonparthmis-client"]=this["webpackJsonparthmis-client"]||[]).push([[478],{1491:function(e,t,n){var a=n(81),r=n(1492);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},1492:function(e,t,n){"use strict";n.r(t);var a=n(48),r=n.n(a)()(!0);r.push([e.i,".u88qc1iT1VdyEswXhrnvb {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n.u88qc1iT1VdyEswXhrnvb ._702hfqesH7qBVQJnnfBHL {\n  position: absolute;\n  top: 0;\n  right: 0;\n  left: 60px;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 50px;\n  background: #fff;\n}\n.u88qc1iT1VdyEswXhrnvb ._702hfqesH7qBVQJnnfBHL .cVpUvgGKh_bQvpG1PGg0t {\n  flex: 1;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN {\n  display: flex;\n  flex: 1;\n  flex-direction: row;\n  width: calc(100vw - 120px);\n  overflow-x: auto;\n  overflow-y: hidden;\n  background: #fff;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ {\n  display: flex;\n  flex: 1;\n  flex-direction: column;\n  min-width: 300px;\n  margin-right: 10px;\n  border: 1px #f5f7f7 solid;\n  box-shadow: 0 0 2px #f0f2f5;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ._19NoPGMf9yT4ezZtiUJ-Nv {\n  min-width: 800px;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ ._1iNtxaRk0BfLOrgtJlFQJh {\n  position: relative;\n  height: 100px;\n  padding: 10px;\n  color: #3f5361;\n  border-bottom: 1px #f5f7f7 solid;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ .LbetHJ4oeH-nOoQROeyPJ {\n  flex-grow: 1;\n  height: 0;\n  overflow: auto;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ .LbetHJ4oeH-nOoQROeyPJ ._2rDysvxr70TOXzgF6lbPaI {\n  position: relative;\n  margin: 5px 5px 10px 5px;\n  padding: 10px;\n  background: #fff;\n  box-shadow: 0 0 2px #b3bdc5;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ .LbetHJ4oeH-nOoQROeyPJ ._2rDysvxr70TOXzgF6lbPaI ._3UePR9wDNnolf3juVDuST4 {\n  color: #3f5361;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ .LbetHJ4oeH-nOoQROeyPJ ._2rDysvxr70TOXzgF6lbPaI ._3_SAhGI8x3X-SWx1Ca6gBV {\n  display: flex;\n  justify-content: flex-end;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ .LbetHJ4oeH-nOoQROeyPJ ._2rDysvxr70TOXzgF6lbPaI::before {\n  position: absolute;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  width: 4px;\n  content: '';\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ .LbetHJ4oeH-nOoQROeyPJ ._2rDysvxr70TOXzgF6lbPaI._5SUjK0w-ebz4vmha5KevB::before {\n  background: #feb312;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ .LbetHJ4oeH-nOoQROeyPJ ._2rDysvxr70TOXzgF6lbPaI.U8Y1c7nnsb2eGOmkThj_M::before {\n  background: #37b184;\n}\n.u88qc1iT1VdyEswXhrnvb ._19nHrBh_EM_4BgGkPBnSJN ._1vHjc7XjiB23ckXDnifOZJ .LbetHJ4oeH-nOoQROeyPJ ._2rDysvxr70TOXzgF6lbPaI._1-RlmwUzwFepkVo_2uZQSk::before {\n  background: #2db7f5;\n}\n","",{version:3,sources:["webpack://src/views/project/index.module.less"],names:[],mappings:"AAEA;EACE,aAAA;EACA,sBAAA;EACA,YAAA;AADF;AAFA;EAKI,kBAAA;EACA,MAAA;EACA,QAAA;EACA,UAAA;EACA,aAAA;EACA,mBAAA;EACA,mBAAA;EACA,YAAA;EACA,gBAAA;AAAJ;AAbA;EAeM,OAAA;AACN;AAhBA;EAoBI,aAAA;EACA,OAAA;EACA,mBAAA;EACA,0BAAA;EACA,gBAAA;EACA,kBAAA;EACA,gBAAA;AADJ;AAzBA;EA6BM,aAAA;EACA,OAAA;EACA,sBAAA;EACA,gBAAA;EACA,kBAAA;EACA,yBAAA;EACA,2BAAA;AADN;AAEM;EACE,gBAAA;AAAR;AArCA;EAwCQ,kBAAA;EACA,aAAA;EACA,aAAA;EACA,cAAA;EACA,gCAAA;AAAR;AA5CA;EA+CQ,YAAA;EACA,SAAA;EACA,cAAA;AAAR;AAjDA;EAmDU,kBAAA;EACA,wBAAA;EACA,aAAA;EACA,gBAAA;EACA,2BAAA;AACV;AAxDA;EAyDY,cAAA;AAEZ;AA3DA;EA4DY,aAAA;EACA,yBAAA;AAEZ;AAAU;EACE,kBAAA;EACA,MAAA;EACA,SAAA;EACA,OAAA;EACA,UAAA;EACA,WAAA;AAEZ;AACY;EACE,mBAAA;AACd;AAGY;EACE,mBAAA;AADd;AAKY;EACE,mBAAA;AAHd",sourcesContent:["@import '@styles/variables.less';\n\n.project-detail-wrap {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  .project-detail-header {\n    position: absolute;\n    top: 0;\n    right: 0;\n    left: 60px;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    height: 50px;\n    background: @bg-white;\n    .left {\n      flex: 1;\n    }\n  }\n\n  .project-detail-body {\n    display: flex;\n    flex: 1;\n    flex-direction: row;\n    width: calc(100vw - 120px);\n    overflow-x: auto;\n    overflow-y: hidden;\n    background: @bg-white;\n\n    .project-detail-group {\n      display: flex;\n      flex: 1;\n      flex-direction: column;\n      min-width: 300px;\n      margin-right: 10px;\n      border: 1px @border solid;\n      box-shadow: 0 0 2px @bg-main;\n      &.project-detail-group-summary {\n        min-width: 800px;\n      }\n      .project-detail-group-header {\n        position: relative;\n        height: 100px;\n        padding: 10px;\n        color: @text-dark;\n        border-bottom: 1px @border solid;\n      }\n      .project-detail-group-body {\n        flex-grow: 1;\n        height: 0;\n        overflow: auto;\n        .project-detail-group-body-task {\n          position: relative;\n          margin: 5px 5px 10px 5px;\n          padding: 10px;\n          background: @bg-white;\n          box-shadow: 0 0 2px @shadow-gray;\n          .title {\n            color: @text-dark;\n          }\n          .footer{\n            display: flex;\n            justify-content: flex-end;\n          }\n          &::before {\n            position: absolute;\n            top: 0;\n            bottom: 0;\n            left: 0;\n            width: 4px;\n            content: '';\n          }\n          &.pending {\n            &::before {\n              background: #feb312;\n            }\n          }\n          &.doing {\n            &::before {\n              background: #37b184;\n            }\n          }\n          &.done {\n            &::before {\n              background: #2db7f5;\n            }\n          }\n        }\n      }\n    }\n  }\n}\n\n@laiye-primary-color: #2249c0;@laiye-link-color: #2249c0;"],sourceRoot:""}]),r.locals={"project-detail-wrap":"u88qc1iT1VdyEswXhrnvb","project-detail-header":"_702hfqesH7qBVQJnnfBHL",left:"cVpUvgGKh_bQvpG1PGg0t","project-detail-body":"_19nHrBh_EM_4BgGkPBnSJN","project-detail-group":"_1vHjc7XjiB23ckXDnifOZJ","project-detail-group-summary":"_19NoPGMf9yT4ezZtiUJ-Nv","project-detail-group-header":"_1iNtxaRk0BfLOrgtJlFQJh","project-detail-group-body":"LbetHJ4oeH-nOoQROeyPJ","project-detail-group-body-task":"_2rDysvxr70TOXzgF6lbPaI",title:"_3UePR9wDNnolf3juVDuST4",footer:"_3_SAhGI8x3X-SWx1Ca6gBV",pending:"_5SUjK0w-ebz4vmha5KevB",doing:"U8Y1c7nnsb2eGOmkThj_M",done:"_1-RlmwUzwFepkVo_2uZQSk"},t.default=r},1493:function(e,t,n){var a=n(81),r=n(1494);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var i={insert:"head",singleton:!1};a(r,i);e.exports=r.locals||{}},1494:function(e,t,n){"use strict";n.r(t);var a=n(48),r=n.n(a)()(!0);r.push([e.i,"._5l2grTZoUJ7McdiL1Hdeb {\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n}\n._5l2grTZoUJ7McdiL1Hdeb ._28O6P9D9kqEGabcIvpbgAn {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  height: 60px;\n}\n._5l2grTZoUJ7McdiL1Hdeb ._28O6P9D9kqEGabcIvpbgAn .zghadyC-qdfIYU9yuGhc7 {\n  flex: 1;\n  color: #3f5361;\n  font-size: 1.25rem;\n}\n._5l2grTZoUJ7McdiL1Hdeb ._3GCnQYGLB_5LFyBzwldOCF {\n  flex: 1;\n}\n._5l2grTZoUJ7McdiL1Hdeb ._3GCnQYGLB_5LFyBzwldOCF ._1EyrldIshmPvxcntw4_ebp {\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  margin-bottom: 12px;\n}\n._5l2grTZoUJ7McdiL1Hdeb ._3GCnQYGLB_5LFyBzwldOCF ._16oxJvIfwPWl3F--MXHuUf {\n  color: #677a8e;\n  font-size: 0.875rem;\n}\n","",{version:3,sources:["webpack://src/components/TaskDetail/index.module.less"],names:[],mappings:"AAGA;EACI,aAAA;EACA,sBAAA;EACA,YAAA;AAFJ;AADA;EAKM,aAAA;EACA,mBAAA;EACA,mBAAA;EACA,YAAA;AADN;AAPA;EAUQ,OAAA;EACA,cAAA;EACA,kBAAA;AAAR;AAZA;EAgBM,OAAA;AADN;AAfA;EAkBQ,aAAA;EACA,mBAAA;EACA,mBAAA;EACA,mBAAA;AAAR;AArBA;EAwBQ,cAAA;EACA,mBAAA;AAAR",sourcesContent:["\n@import '@styles/variables.less';\n\n.detail-wrap {\n    display: flex;\n    flex-direction: column;\n    height: 100%;\n    .detail-header {\n      display: flex;\n      flex-direction: row;\n      align-items: center;\n      height: 60px;\n      .title{\n        flex:1;\n        color: @text-dark;\n        font-size: 1.25rem;\n      }\n    }\n    .detail-body {\n      flex: 1;\n      .detail-tools{\n        display: flex;\n        flex-direction: row;\n        align-items: center;\n        margin-bottom: 12px;\n      }\n      .description{\n        color: @text-desc;\n        font-size: .875rem;\n      }\n    }\n  }\n  \n@laiye-primary-color: #2249c0;@laiye-link-color: #2249c0;"],sourceRoot:""}]),r.locals={"detail-wrap":"_5l2grTZoUJ7McdiL1Hdeb","detail-header":"_28O6P9D9kqEGabcIvpbgAn",title:"zghadyC-qdfIYU9yuGhc7","detail-body":"_3GCnQYGLB_5LFyBzwldOCF","detail-tools":"_1EyrldIshmPvxcntw4_ebp",description:"_16oxJvIfwPWl3F--MXHuUf"},t.default=r},1500:function(e,t,n){"use strict";var a=n(0),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M482 152h60q8 0 8 8v704q0 8-8 8h-60q-8 0-8-8V160q0-8 8-8z"}},{tag:"path",attrs:{d:"M176 474h672q8 0 8 8v60q0 8-8 8H176q-8 0-8-8v-60q0-8 8-8z"}}]},name:"plus",theme:"outlined"},i=n(21),s=function(e,t){return a.createElement(i.a,Object.assign({},e,{ref:t,icon:r}))};s.displayName="PlusOutlined";t.a=a.forwardRef(s)},1501:function(e,t,n){"use strict";var a=n(0),r={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"},i=n(21),s=function(e,t){return a.createElement(i.a,Object.assign({},e,{ref:t,icon:r}))};s.displayName="DeleteOutlined";t.a=a.forwardRef(s)},1506:function(e,t,n){"use strict";n.r(t),n.d(t,"default",(function(){return ce}));n(606);var a=n(592),r=n.n(a),i=(n(180),n(58)),s=n.n(i),c=n(117),o=n(16),l=n(55),u=n.n(l),d=n(82),A=n(30),h=n(31),p=n(33),f=n(32),b=n(1500),j=n(0),v={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M947.2 294.4a64 64 0 00-97.28-82.94l-5.12 6.14L512 661.31 179.2 217.6a64 64 0 00-82.88-17.22l-6.72 4.48a64 64 0 00-17.28 82.82l4.48 6.72 384 512a64 64 0 0096.96 6.4l5.44-6.4 384-512z"}}]},name:"down",theme:"outlined"},m=n(21),x=function(e,t){return j.createElement(m.a,Object.assign({},e,{ref:t,icon:v}))};x.displayName="DownOutlined";var g=j.forwardRef(x),k=n(578),O=n(579),y=n(138),_=n.n(y),w=n(1491),E=n.n(w),B=n(22),C=n(182),D=(n(274),n(178)),J=n.n(D),T=(n(589),n(590)),H=n.n(T),S=(n(584),n(586)),M=n.n(S),N=n(601),X=n.n(N),P=n(2),I=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(A.a)(this,n),(a=t.call(this,e)).state={loading:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){}},{key:"cancel",value:function(e){e.preventDefault(),this.props.callback({isVisible:!1,isRefresh:!1,values:""})}},{key:"handleSubmit",value:function(e){this.props.callback({isVisible:!1,isRefresh:!0,values:e})}},{key:"render",value:function(){var e=this.props.entity;return Object(P.jsxs)(H.a,{labelCol:{span:24},wrapperCol:{span:24},onFinish:this.handleSubmit.bind(this),initialValues:{name:e?e.name:"",description:e?e.description:""},children:[Object(P.jsx)(H.a.Item,{label:"\u540d\u79f0",name:"name",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8fed\u4ee3\u540d"}],children:Object(P.jsx)(M.a,{placeholder:"\u8bf7\u8f93\u5165\u8fed\u4ee3\u540d"})}),Object(P.jsx)(H.a.Item,{label:"\u63cf\u8ff0",name:"description",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u63cf\u8ff0"}],children:Object(P.jsx)(X.a,{rows:4,placeholder:"\u8bf7\u8f93\u5165\u63cf\u8ff0"})}),Object(P.jsxs)(H.a.Item,{children:[Object(P.jsx)(J.a,{type:"primary",htmlType:"submit",className:"m-r-12",children:B.a.t("action.save")}),Object(P.jsxs)(J.a,{onClick:this.cancel.bind(this),children:[" ",B.a.t("action.cancel")]})]})]})}}]),n}(j.Component),V=n(49),G=n(576),q=n(662),z=(n(283),n(197)),L=n.n(z),R=n(1501),U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M174.5 399.5a112.5 112.5 0 11-.06 225 112.5 112.5 0 01.06-225zm337.5 0a112.5 112.5 0 11-.06 225 112.5 112.5 0 01.06-225zm337.5 0a112.5 112.5 0 11-.06 225 112.5 112.5 0 01.06-225z"}}]},name:"ellipsis",theme:"outlined"},F=function(e,t){return j.createElement(m.a,Object.assign({},e,{ref:t,icon:U}))};F.displayName="EllipsisOutlined";var Q=j.forwardRef(F),Z=n(103),Y=n(187),K=n.n(Y),W=n(573),$=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(A.a)(this,n),(a=t.call(this,e)).state={current:null,users:[]},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=Object(d.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.getUserList();case 1:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserList",value:function(){var e=Object(d.a)(u.a.mark((function e(){var t,n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(Z.e)();case 2:t=e.sent,n=t.data,a=this.props.userId,this.setState({users:n,current:Object(V.find)(n,{_id:a})});case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentWillReceiveProps",value:function(e){e.userId!==this.props.userId&&this.getUserList()}},{key:"userActions",value:function(e){var t=e.key,n=this.props.callBack;n&&n(t)}},{key:"render",value:function(){var e=this,t=this.state,n=t.current,a=t.users,i=Object(P.jsx)(s.a,{style:{width:200},onClick:function(t){e.userActions(t)},children:a.map((function(e){return Object(P.jsx)(s.a.Item,{children:e.username},e._id)}))});return Object(P.jsx)(r.a,{overlay:i,children:Object(P.jsx)("div",{children:Object(P.jsx)(K.a,{style:{backgroundColor:"#2db7f5"},size:40,children:n?n.username:Object(P.jsx)(W.a,{})})})})}}]),n}(j.Component),ee=(n(659),n(681)),te=n.n(ee),ne=n(183),ae=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(A.a)(this,n),(a=t.call(this,e)).state={current:null},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.status;this.setState({current:ne.b[e||"0"]})}},{key:"componentWillReceiveProps",value:function(e){e.status!==this.props.status&&this.setState({current:ne.b[e.status||"0"]})}},{key:"stateActions",value:function(e){var t=e.key,n=this.props.callBack;n&&n(t)}},{key:"render",value:function(){var e=this,t=this.state.current,n=Object(P.jsxs)(s.a,{style:{width:200},onClick:function(t){e.stateActions(t)},children:[Object(P.jsx)(s.a.Item,{children:"\u672a\u5f00\u59cb"},ne.a.PENDING),Object(P.jsx)(s.a.Item,{children:"\u8fdb\u884c\u4e2d"},ne.a.DOING),Object(P.jsx)(s.a.Item,{children:"\u5df2\u5b8c\u6210"},ne.a.DONE)]});return Object(P.jsx)(r.a,{overlay:n,children:Object(P.jsx)("div",{children:Object(P.jsx)(te.a,{color:null===t||void 0===t?void 0:t.color,children:null===t||void 0===t?void 0:t.label})})})}}]),n}(j.Component),re=n(1493),ie=n.n(re),se=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(A.a)(this,n),(a=t.call(this,e)).onCloseDetail=function(){a.setState({isTaskDetailVisible:!1})},a.state={taskDetail:null,isTaskDetailVisible:!1,isDescriptionEditor:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.taskId;this.getTask(e)}},{key:"componentWillReceiveProps",value:function(e){e.taskId!==this.props.taskId&&this.getTask(e.taskId)}},{key:"getTask",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.d)(t);case 2:(n=e.sent)&&this.setState({taskDetail:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setVisible",value:function(e){this.setState({isTaskDetailVisible:e})}},{key:"showDescriptionEditor",value:function(){this.setState({isDescriptionEditor:!0})}},{key:"saveDescription",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.h)(this.state.taskDetail._id,{description:t.target.value});case 2:n=e.sent,this.setState({taskDetail:n,isDescriptionEditor:!1});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"taskActions",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("delete"!==t.key){e.next=5;break}return e.next=4,Object(G.b)(this.state.taskDetail._id);case 4:this.onCloseDetail();case 5:(n=this.props.afterAction)&&n(null);case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"taskStateActions",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.key,e.next=3,Object(G.h)(this.state.taskDetail._id,{state:n});case 3:e.sent;case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changeCharger",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.h)(this.state.taskDetail._id,{charger:t});case 2:(n=e.sent)&&this.setState({taskDetail:n}),(a=this.props.afterAction)&&a(null);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"changeState",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.h)(this.state.taskDetail._id,{state:t});case 2:(n=e.sent)&&this.setState({taskDetail:n}),(a=this.props.afterAction)&&a(null);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this,t=this.state,n=t.taskDetail,a=t.isTaskDetailVisible,i=t.isDescriptionEditor,c=Object(P.jsx)(s.a,{onClick:function(t){e.taskActions(t)},children:Object(P.jsxs)(s.a.Item,{children:[Object(P.jsx)(R.a,{}),"\u5220\u9664"]},"delete")});return Object(P.jsx)(L.a,{title:null,placement:"right",width:1024,destroyOnClose:!0,closable:!1,onClose:this.onCloseDetail,visible:a,children:Object(P.jsxs)("div",{className:ie.a["detail-wrap"],children:[Object(P.jsxs)("div",{className:ie.a["detail-header"],children:[Object(P.jsx)("div",{className:ie.a.title,children:n&&n.name}),Object(P.jsx)("div",{className:ie.a.actions,children:Object(P.jsx)(r.a,{overlay:c,children:Object(P.jsx)(Q,{})})})]}),Object(P.jsxs)("div",{className:ie.a["detail-body"],children:[Object(P.jsxs)("div",{className:ie.a["detail-tools"],children:[Object(P.jsx)("div",{className:"m-r-12",children:Object(P.jsx)($,{userId:n&&n.charger?n.charger._id:null,callBack:function(t){e.changeCharger(t)}})}),Object(P.jsx)(ae,{status:null===n||void 0===n?void 0:n.state,callBack:function(t){e.changeState(t)}})]}),i?Object(P.jsx)("div",{className:ie.a["description-editor"],children:Object(P.jsx)(X.a,{defaultValue:n&&n.description?n.description:"",onBlur:function(t){e.saveDescription(t)},rows:10})}):Object(P.jsx)("div",{className:ie.a.description,onClick:function(){e.showDescriptionEditor()},children:n&&n.description?n.description:"\u6dfb\u52a0\u63cf\u8ff0"})]})]})})}}]),n}(j.Component),ce=function(e){Object(p.a)(n,e);var t=Object(f.a)(n);function n(e){var a;return Object(A.a)(this,n),(a=t.call(this,e)).detailModel=null,a.closeCollection=function(){a.setState({isScrumCollectionVisible:!1})},a.state={current:null,scrums:[],project:null,isScrumCollectionVisible:!1,groupTaskMap:{},isTaskDetailVisible:!1,taskDetail:null,isDescriptionEditor:!1},a}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.match.params.id;this.getProject(e),this.getScrums(e)}},{key:"getProject",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.c)(t);case 2:n=e.sent,this.setState({project:n});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getScrums",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.b)({projectId:t});case 2:(n=e.sent)&&(this.setState({scrums:n,current:n[0]}),this.getScrumTask(n[0]._id));case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"getScrumTask",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.e)({scrum:t});case 2:(n=e.sent)&&this.setState({groupTaskMap:Object(V.groupBy)(n,"group")});case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"selectMenu",value:function(e){var t=e.key;"create"===t?this.setState({isScrumCollectionVisible:!0}):this.setState({current:Object(V.find)(this.state.scrums,{_id:t})})}},{key:"collectionCallBack",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isVisible,t.isRefresh,n=t.values,!(a=void 0===n?"":n)){e.next=6;break}return e.next=4,Object(O.a)(Object(o.a)(Object(o.a)({},a),{},{project:this.state.project._id}));case 4:e.sent,this.getScrums(this.state.project._id);case 6:this.setState({isScrumCollectionVisible:!1});case 7:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addTask",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(13!==t.keyCode||!t.target.value){e.next=6;break}return e.next=3,Object(G.a)({name:t.target.value,group:n._id,scrum:this.state.current._id,project:this.state.project._id});case 3:e.sent,this.getScrumTask(this.state.current._id),setTimeout((function(){t.target.value=""}),200);case 6:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"showTaskDetail",value:function(){var e=Object(d.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(G.d)(t._id);case 2:n=e.sent,this.setState({taskDetail:n}),this.detailModel&&this.detailModel.setVisible(!0);case 5:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"setList",value:function(e,t){this.state.groupTaskMap[e._id]=Object(c.a)(t),this.setState({groupTaskMap:Object(o.a)({},this.state.groupTaskMap)})}},{key:"updateChangeTask",value:function(){var e=Object(d.a)(u.a.mark((function e(t,n){var a,r,i,s,c,o,l,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.item,r=n.to,i=n.from,s=n.oldIndex,c=n.newIndex,o=a.getAttribute("data-id"),l=i.getAttribute("id"),d=r.getAttribute("id"),e.next=6,Object(G.f)(o,{fromId:l,toId:d,oldIndex:s,newIndex:c});case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"getDetail",value:function(e){e&&(this.detailModel=e)}},{key:"detailCallBack",value:function(e){this.getScrumTask(this.state.current._id)}},{key:"render",value:function(){var e=this,t=this.state,n=t.project,a=t.scrums,i=t.isScrumCollectionVisible,c=t.current,o=t.groupTaskMap,l=(t.isTaskDetailVisible,t.taskDetail),u=(t.isDescriptionEditor,Object(P.jsxs)(s.a,{onClick:function(t){e.selectMenu(t)},children:[a.map((function(e){return Object(P.jsx)(s.a.Item,{children:e.name},e._id)})),Object(P.jsx)(s.a.Divider,{}),Object(P.jsxs)(s.a.Item,{children:[Object(P.jsx)(b.a,{})," \u65b0\u5efa\u8fed\u4ee3"]},"create")]}));return Object(P.jsxs)(P.Fragment,{children:[Object(P.jsxs)("div",{className:E.a["project-detail-wrap"],children:[Object(P.jsxs)("div",{className:E.a["project-detail-header"],children:[Object(P.jsxs)("span",{className:E.a["project-detail-title"],children:[Object(P.jsx)("i",{className:"cloud cloud-project m-r-4 m-l-12"}),null===n||void 0===n?void 0:n.name]}),Object(P.jsx)(r.a,{overlay:u,children:Object(P.jsxs)("a",{className:"ant-dropdown-link m-l-12",onClick:function(e){return e.preventDefault()},children:[c?c.name:"\u8fed\u4ee3"," ",Object(P.jsx)(g,{})]})})]}),Object(P.jsx)("div",{className:E.a["project-detail-body"],children:c&&c.groups?Object(P.jsx)(P.Fragment,{children:c.groups.map((function(t){return Object(P.jsxs)("div",{className:"".concat(E.a["project-detail-group"]," ").concat(5===t.type?E.a["project-detail-group-summary"]:""),children:[Object(P.jsxs)("div",{className:E.a["project-detail-group-header"],children:[Object(P.jsx)("div",{children:t.name}),5!==t.type?Object(P.jsx)("div",{children:Object(P.jsx)(X.a,{onKeyDown:function(n){e.addTask(n,t)},rows:2})}):null]}),Object(P.jsx)("div",{className:E.a["project-detail-group-body"],children:o[t._id]?Object(P.jsx)(P.Fragment,{children:Object(P.jsx)(q.ReactSortable,{id:t._id,group:"tasks",list:o[t._id],setList:function(n){return e.setList(t,n)},onEnd:function(n){return e.updateChangeTask(t,n)},children:o[t._id].map((function(t){return Object(P.jsxs)("div",{className:"".concat(E.a["project-detail-group-body-task"]," ").concat(E.a[ne.b[t.state||0].className]),onClick:function(){e.showTaskDetail(t)},children:[Object(P.jsx)("div",{className:E.a.title,children:t.name}),Object(P.jsx)("div",{className:E.a.footer,children:t.charger?Object(P.jsx)(K.a,{style:{backgroundColor:"#2db7f5"},size:36,children:t.charger.username}):null})]},t._id)}))})}):null})]},t._id)}))}):null})]}),Object(P.jsx)(_.a,{title:B.a.t("action.create"),visible:i,width:C.b.md,destroyOnClose:!0,footer:!1,onCancel:this.closeCollection.bind(this),children:Object(P.jsx)(I,{entity:null,callback:this.collectionCallBack.bind(this)})}),Object(P.jsx)(P.Fragment,{children:l?Object(P.jsx)(se,{ref:function(t){e.getDetail(t)},taskId:l._id,afterAction:function(t){e.detailCallBack(t)}}):null})]})}}]),n}(j.Component)},576:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"h",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"d",(function(){return c})),n.d(t,"e",(function(){return o})),n.d(t,"f",(function(){return l})),n.d(t,"g",(function(){return u})),n.d(t,"c",(function(){return d}));var a=n(54),r=function(e){return Object(a.a)({url:"/tasks",method:"post",data:e})},i=function(e,t){return Object(a.a)({url:"/tasks/".concat(e),method:"put",data:t})},s=function(e){return Object(a.a)({url:"/tasks/".concat(e),method:"delete"})},c=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(a.a)({url:"/tasks/".concat(e),method:"get",params:t})},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a.a)({url:"/tasks",method:"get",params:e})},l=function(e,t){return Object(a.a)({url:"/tasks/".concat(e,"/sort"),method:"post",data:t})},u=function(e){return Object(a.a)({url:"/task-summary",method:"post",data:e})},d=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a.a)({url:"/task-summary",method:"get",params:e})}},578:function(e,t,n){"use strict";n.d(t,"d",(function(){return r})),n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"b",(function(){return o}));var a=n(54),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a.a)({url:"/projects",method:"get",params:e})},i=function(e){return Object(a.a)({url:"/projects",method:"post",data:e})},s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object(a.a)({url:"/projects/".concat(e),method:"get",params:t})},c=function(e,t){return Object(a.a)({url:"/projects/".concat(e),method:"put",data:t})},o=function(e){return Object(a.a)({url:"/projects/".concat(e),method:"delete"})}},579:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var a=n(54),r=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(a.a)({url:"/scrums",method:"get",params:e})},i=function(e){return Object(a.a)({url:"/scrums",method:"post",data:e})}}}]);
//# sourceMappingURL=478.1728ad32.chunk.js.map